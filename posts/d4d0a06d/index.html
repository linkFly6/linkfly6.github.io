<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  
  <title>JavaScript 和 TypeScript 交叉口 —— 类型定义文件(*.d.ts) | 听说 - 世界很大，风住过这里</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta name="description" content="在 《从 JavaScript 到 TypeScript 系列》 文章我们已经学习了 TypeScript 相关的知识。TypeScript 的核心在于静态类型，我们在编写 TS 的时候会定义很多的类型，但是主流的库都是 JavaScript 编写的，并不支持类型系统。那么如何让这些第三方库也可以进行类型推导呢？ 这篇文章我们来讲解 JavaScript 和 TypeScript 的静态类型交叉口">
<meta property="og:type" content="article">
<meta property="og:title" content="JavaScript 和 TypeScript 交叉口 —— 类型定义文件(*.d.ts)">
<meta property="og:url" content="http://example.com/posts/d4d0a06d/index.html">
<meta property="og:site_name" content="听说 - 世界很大，风住过这里">
<meta property="og:description" content="在 《从 JavaScript 到 TypeScript 系列》 文章我们已经学习了 TypeScript 相关的知识。TypeScript 的核心在于静态类型，我们在编写 TS 的时候会定义很多的类型，但是主流的库都是 JavaScript 编写的，并不支持类型系统。那么如何让这些第三方库也可以进行类型推导呢？ 这篇文章我们来讲解 JavaScript 和 TypeScript 的静态类型交叉口">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="http://static.tasaid.com/blogs/2094b0e190bf5c66045488f3c2cab5e5.png">
<meta property="og:image" content="http://static.tasaid.com/blogs/26a7416bf2b8b2eebb74a32d2015eed3.png">
<meta property="og:image" content="http://static.tasaid.com/blogs/b53c668059b6fc2f87dda190536d04f6.png">
<meta property="article:published_time" content="2017-11-02T14:51:00.000Z">
<meta property="article:modified_time" content="2018-08-27T12:19:30.000Z">
<meta property="article:author" content="John Doe">
<meta property="article:tag" content="TypeScript">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://static.tasaid.com/blogs/2094b0e190bf5c66045488f3c2cab5e5.png">
  
    <link rel="alternate" href="/atom.xml" title="听说 - 世界很大，风住过这里" type="application/atom+xml">
  
  
    <link rel="shortcut icon" href="/favicon.png">
  
  
    
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/typeface-source-code-pro@0.0.71/index.min.css">

  
  
<link rel="stylesheet" href="/css/style.css">

  
    
<link rel="stylesheet" href="/fancybox/jquery.fancybox.min.css">

  
  
<meta name="generator" content="Hexo 7.0.0"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">听说 - 世界很大，风住过这里</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"><span class="fa fa-bars"></span></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
        
          <a class="nav-icon" href="/atom.xml" title="RSS Feed"><span class="fa fa-rss"></span></a>
        
        <a class="nav-icon nav-search-btn" title="Search"><span class="fa fa-search"></span></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://example.com"></form>
      </div>
    </div>
  </div>
</header>

      <div class="outer">
        <section id="main"><article id="post-blogs/JavaScript和TypeScript交叉口——类型定义文件" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/posts/d4d0a06d/" class="article-date">
  <time class="dt-published" datetime="2017-11-02T14:51:00.000Z" itemprop="datePublished">2017-11-02</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/tech/">tech</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="p-name article-title" itemprop="headline name">
      JavaScript 和 TypeScript 交叉口 —— 类型定义文件(*.d.ts)
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>在 <a target="_blank" rel="noopener" href="http://tasaid.com/blog/20171011231943.html">《从 JavaScript 到 TypeScript 系列》</a> 文章我们已经学习了 TypeScript 相关的知识。<br>TypeScript 的核心在于静态类型，我们在编写 TS 的时候会定义很多的类型，但是主流的库都是 JavaScript 编写的，并不支持类型系统。那么如何让这些第三方库也可以进行类型推导呢？</p>
<p>这篇文章我们来讲解 JavaScript 和 TypeScript 的静态类型交叉口 —— 类型定义文件。</p>
<blockquote>
<p>前端开发 QQ 群：377786580</p>
</blockquote>
<h2 id="类型定义文件"><a href="#类型定义文件" class="headerlink" title="类型定义文件"></a>类型定义文件</h2><p>在 TypeScript 中，我们可以很简单的，在代码编写中定义类型：</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">interface</span> <span class="title class_">IBaseModel</span> &#123;</span><br><span class="line">  <span class="title function_">say</span>(<span class="attr">keys</span>: <span class="built_in">string</span>[] | <span class="literal">null</span>): <span class="built_in">object</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">User</span> <span class="keyword">implements</span> <span class="title class_">IBaseModel</span> &#123;</span><br><span class="line">  <span class="attr">name</span>: <span class="built_in">string</span></span><br><span class="line">  <span class="title function_">constructor</span> (<span class="attr">name</span>: <span class="built_in">string</span>) &#123;</span><br><span class="line">	<span class="variable language_">this</span>.<span class="property">name</span> = name</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>但是主流的库都是 JavaScript 编写的，TypeScript 身为 JavaScript 的超集，自然需要考虑到如何让 JS 库也能定义静态类型。</p>
<p>TypeScript 经过了一系列的摸索，先后提出了 <a target="_blank" rel="noopener" href="https://github.com/DefinitelyTyped/tsd">tsd</a>(已废弃)、<a target="_blank" rel="noopener" href="https://github.com/typings/typings">typings</a>(已废弃)，最终在 TypeScript 2.0 的时候重新整理了类型定义，提出了 <a target="_blank" rel="noopener" href="https://github.com/DefinitelyTyped/DefinitelyTyped">DefinitelyTyped</a>。</p>
<p><a target="_blank" rel="noopener" href="https://github.com/DefinitelyTyped/DefinitelyTyped">DefinitelyTyped</a> 就是让你把 “类型定义文件(*.d.ts)”，发布到 <code>npm</code> 中，配合编辑器(或插件)，就能够检测到 JS 库中的静态类型。</p>
<p>类型定义文件的以 <code>.d.ts</code> 结尾，里面主要用来定义类型。</p>
<p>例如这是 <a target="_blank" rel="noopener" href="https://github.com/DefinitelyTyped/DefinitelyTyped/tree/master/types/jquery">jQuery 的类型定义文件</a> 中一段代码（为了方便理解做了一些改动）</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 定义 jQuery 需要用到的类型命名空间</span></span><br><span class="line"><span class="keyword">declare</span> <span class="keyword">namespace</span> <span class="title class_">JQuery</span> &#123;</span><br><span class="line">	<span class="comment">// 定义基本使用的类型</span></span><br><span class="line">	<span class="keyword">type</span> <span class="title class_">Selector</span> = <span class="built_in">string</span>;</span><br><span class="line">	<span class="keyword">type</span> <span class="title class_">TypeOrArray</span>&lt;T&gt; = T | T[];</span><br><span class="line">	<span class="keyword">type</span> htmlString = <span class="built_in">string</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 定义 jQuery 接口，jquery 是一个 包含 Element 的集合</span></span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">JQuery</span>&lt;<span class="title class_">TElement</span> <span class="keyword">extends</span> <span class="title class_">Node</span> = <span class="title class_">HTMLElement</span>&gt; <span class="keyword">extends</span> <span class="title class_">Iterable</span>&lt;<span class="title class_">TElement</span>&gt; &#123;</span><br><span class="line">	<span class="attr">length</span>: <span class="built_in">number</span>;</span><br><span class="line">	<span class="title function_">eq</span>(<span class="attr">index</span>: <span class="built_in">number</span>): <span class="variable language_">this</span>;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">// 重载</span></span><br><span class="line">	<span class="title function_">add</span>(<span class="attr">selector</span>: <span class="title class_">JQuery</span>.<span class="property">Selector</span>, <span class="attr">context</span>: <span class="title class_">Element</span>): <span class="variable language_">this</span>;</span><br><span class="line">	<span class="title function_">add</span>(<span class="attr">selector</span>: <span class="title class_">JQuery</span>.<span class="property">Selector</span> | <span class="title class_">JQuery</span>.<span class="property">TypeOrArray</span>&lt;<span class="title class_">Element</span>&gt; | <span class="title class_">JQuery</span>.<span class="property">htmlString</span> | <span class="title class_">JQuery</span>): <span class="variable language_">this</span>;</span><br><span class="line">	</span><br><span class="line">	<span class="title function_">children</span>(selector?: <span class="title class_">JQuery</span>.<span class="property">Selector</span>): <span class="variable language_">this</span>;</span><br><span class="line">	<span class="title function_">css</span>(<span class="attr">propertyName</span>: <span class="built_in">string</span>): <span class="built_in">string</span>;</span><br><span class="line">	<span class="title function_">html</span>(): <span class="built_in">string</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 对模块 jquery 输出接口</span></span><br><span class="line"><span class="keyword">declare</span> <span class="variable language_">module</span> <span class="string">&#x27;jquery&#x27;</span> &#123;</span><br><span class="line">	<span class="comment">// module 中要使用 export = 而不是 export default</span></span><br><span class="line">    <span class="keyword">export</span> = jQuery;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="类型定义"><a href="#类型定义" class="headerlink" title="类型定义"></a>类型定义</h2><p><code>*.d.ts</code> 编写起来非常简单，经过 TypeScript 良好的静态类型系统洗礼过后，语法学习成本非常低。</p>
<p>我们可以使用 <code>type</code> 用来定义类型变量：</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 基本类型</span></span><br><span class="line"><span class="keyword">type</span> <span class="title class_">UserName</span> = <span class="built_in">string</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 类型赋值</span></span><br><span class="line"><span class="keyword">type</span> <span class="title class_">WebSite</span> = <span class="built_in">string</span></span><br><span class="line"><span class="keyword">type</span> <span class="title class_">Tsaid</span> = <span class="title class_">WebSite</span></span><br></pre></td></tr></table></figure>

<p>可以看到 <code>type</code> 其实可以定义各种格式的类型，也可以和其他类型进行组合。</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 对象</span></span><br><span class="line"><span class="keyword">type</span> <span class="title class_">User</span> = &#123;</span><br><span class="line">  <span class="attr">name</span>: <span class="built_in">string</span>;</span><br><span class="line">  <span class="attr">age</span>: <span class="built_in">number</span>;</span><br><span class="line">  <span class="attr">website</span>: <span class="title class_">WebSite</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 方法</span></span><br><span class="line"><span class="keyword">type</span> say = <span class="function">(<span class="params">age: <span class="built_in">number</span></span>) =&gt;</span> <span class="built_in">string</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 类</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">TaSaid</span> &#123;</span><br><span class="line">  <span class="attr">website</span>: <span class="built_in">string</span>;</span><br><span class="line">  <span class="attr">say</span>: <span class="function">(<span class="params">age: <span class="built_in">number</span></span>) =&gt;</span> <span class="built_in">string</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>当然，我们也可以使用 <code>interface</code> 定义我们的复杂类型，在 TS 中我们也可以直接定义 <code>interface</code>：</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">interface</span> <span class="title class_">Application</span> &#123;</span><br><span class="line">	<span class="title function_">init</span>(): <span class="built_in">void</span></span><br><span class="line">	<span class="title function_">get</span>(<span class="attr">key</span>: <span class="built_in">string</span>): <span class="built_in">object</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><code>interface</code> 和 <code>type</code>(或者说 <code>class</code>) 很像。</p>
<p>但是 <code>type</code> 的含义是定义自定义类型，当 TS 提供给你的基础类型都不满足的时候，可以使用 <code>type</code> 自由组合出你的新类型，而 <code>interface</code> 应该是对外输出的接口。</p>
<p><code>type</code> 不可以被继承，但 <code>interface</code> 可以：</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">interface</span> <span class="title class_">BaseApplication</span> &#123;</span><br><span class="line">	<span class="attr">appId</span>: <span class="built_in">number</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">interface</span> <span class="title class_">Application</span> <span class="keyword">extends</span> <span class="title class_">BaseApplication</span> &#123;</span><br><span class="line">  <span class="title function_">init</span>(): <span class="built_in">void</span></span><br><span class="line">	<span class="title function_">get</span>(<span class="attr">key</span>: <span class="built_in">string</span>): <span class="built_in">object</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


<h2 id="declare"><a href="#declare" class="headerlink" title="declare"></a>declare</h2><p><code>declare</code> 可以创建 <code>*.d.ts</code> 文件中的变量，<code>declare</code> 只能作用域最外层：</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">declare</span> <span class="keyword">var</span> <span class="attr">foo</span>: <span class="built_in">number</span>;</span><br><span class="line"><span class="keyword">declare</span> <span class="keyword">function</span> <span class="title function_">greet</span>(<span class="params">greeting: <span class="built_in">string</span></span>): <span class="built_in">void</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">declare</span> <span class="keyword">namespace</span> tasaid &#123;</span><br><span class="line">  <span class="comment">// 这里不能 declare</span></span><br><span class="line">  <span class="keyword">interface</span> blog &#123;</span><br><span class="line">    <span class="attr">website</span>: <span class="string">&#x27;http://tasaid.com&#x27;</span></span><br><span class="line">  &#125; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>基本上顶层的定义都需要使用 <code>declare</code>， <code>class</code> 也是：</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">declare</span> <span class="keyword">class</span> <span class="title class_">User</span> &#123;</span><br><span class="line">  <span class="attr">name</span>: <span class="built_in">string</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="namespace"><a href="#namespace" class="headerlink" title="namespace"></a>namespace</h2><p>为防止类型重复，使用 <code>namespace</code> 用于划分区域块，分离重复的类型，顶层的 <code>namespace</code> 需要 <code>declare</code> 输出到外部环境，子命名空间不需要 <code>declare</code>。</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 命名空间</span></span><br><span class="line"><span class="keyword">declare</span> <span class="keyword">namespace</span> <span class="title class_">Models</span> &#123;</span><br><span class="line">  <span class="keyword">type</span> A = <span class="built_in">number</span></span><br><span class="line">  <span class="comment">// 子命名空间</span></span><br><span class="line">  <span class="keyword">namespace</span> <span class="title class_">Config</span> &#123;</span><br><span class="line">    <span class="keyword">type</span> A = <span class="built_in">object</span></span><br><span class="line">    <span class="keyword">type</span> B = <span class="built_in">string</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> C = <span class="title class_">Models</span>.<span class="property">Config</span>.<span class="property">A</span></span><br></pre></td></tr></table></figure>



<h2 id="组合定义"><a href="#组合定义" class="headerlink" title="组合定义"></a>组合定义</h2><p>上面我们只演示了一些简单的类型组合，生产环境中会包含许多复杂的类型定义，这时候我们就需要各种组合出强大的类型定义：</p>
<h3 id="动态属性"><a href="#动态属性" class="headerlink" title="动态属性"></a>动态属性</h3><p>有些类型的属性名是动态而未知的，例如：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="string">&#x27;10086&#x27;</span>: &#123;</span><br><span class="line">    <span class="attr">name</span>: <span class="string">&#x27;中国移动&#x27;</span>,</span><br><span class="line">    <span class="attr">website</span>: <span class="string">&#x27;http://www.10086.cn&#x27;</span>,</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="string">&#x27;10010&#x27;</span>: &#123;</span><br><span class="line">    <span class="attr">name</span>: <span class="string">&#x27;中国联通&#x27;</span>,</span><br><span class="line">    <span class="attr">website</span>: <span class="string">&#x27;http://www.10010.com&#x27;</span>,</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="string">&#x27;10000&#x27;</span>: &#123;</span><br><span class="line">    <span class="attr">name</span>: <span class="string">&#x27;中国电信&#x27;</span>,</span><br><span class="line">    <span class="attr">website</span>: <span class="string">&#x27;http://www.189.cn&#x27;</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>我们可以使用动态属性名来定义类型：</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">interface</span> <span class="title class_">ChinaMobile</span> &#123;</span><br><span class="line">  <span class="attr">name</span>: <span class="built_in">string</span>;</span><br><span class="line">  <span class="attr">website</span>: <span class="built_in">string</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">ChinaMobileList</span> &#123;</span><br><span class="line">  <span class="comment">// 动态属性</span></span><br><span class="line">  [<span class="attr">phone</span>: <span class="built_in">string</span>]: <span class="title class_">ChinaMobile</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="类型遍历"><a href="#类型遍历" class="headerlink" title="类型遍历"></a>类型遍历</h3><p>当你已知某个类型范围的时候，可以使用 <code>in</code> 和 <code>keyof</code> 来遍历类型，例如上面的 ChinaMobile 例子，我们可以使用 <code>in</code> 来约束属性名必须为三家运营商之一：</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> <span class="title class_">ChinaMobilePhones</span> = <span class="string">&#x27;10086&#x27;</span> | <span class="string">&#x27;10010&#x27;</span> | <span class="string">&#x27;10000&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">ChinaMobile</span> &#123;</span><br><span class="line">  <span class="attr">name</span>: <span class="built_in">string</span>;</span><br><span class="line">  <span class="attr">website</span>: <span class="built_in">string</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 只能 type 使用， interface 无法使用</span></span><br><span class="line"><span class="keyword">type</span> <span class="title class_">ChinaMobileList</span> = &#123;</span><br><span class="line">  <span class="comment">// 遍历属性</span></span><br><span class="line">  [phone <span class="keyword">in</span> <span class="title class_">ChinaMobilePhones</span>]: <span class="title class_">ChinaMobile</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>我们也可以用 <code>keyof</code> 来约定方法的参数</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">type</span> keys = &#123;</span><br><span class="line">  <span class="attr">name</span>: <span class="built_in">string</span>;</span><br><span class="line">  <span class="attr">appId</span>: <span class="built_in">number</span>;</span><br><span class="line">  <span class="attr">config</span>: <span class="built_in">object</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Application</span> &#123;</span><br><span class="line">  <span class="comment">// 参数和值约束范围</span></span><br><span class="line">  set&lt;T <span class="keyword">extends</span> keyof keys&gt;(<span class="attr">key</span>: T, <span class="attr">val</span>: keys[T])</span><br><span class="line">  get&lt;T <span class="keyword">extends</span> keyof keys&gt;(<span class="attr">key</span>: T): keys[T]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="//static.tasaid.com/blogs/2094b0e190bf5c66045488f3c2cab5e5.png" alt="keyof"></p>
<h2 id="import-导入和-export-导出"><a href="#import-导入和-export-导出" class="headerlink" title="import 导入和 export 导出"></a>import 导入和 export 导出</h2><p>js 中有多种 <code>import</code> 和 <code>export </code>模块的方式，所以在 <code>d.ts</code>  中也对应有着不同的导入导出方式。</p>
<h3 id="导入规则"><a href="#导入规则" class="headerlink" title="导入规则"></a>导入规则</h3><p>在 ts 中不同的 <code>import</code> 语法会决定如何解析这个 module：</p>
<ul>
<li>有类型声明，标准 es module 库：<code>import * as xxxx from &#39;&#39;</code> 或 <code>import xxx from &#39;&#39;</code> 导入</li>
<li>有类型声明，标准 commonjs 库： <code>import xxx = require(&#39;&#39;)</code> 导入</li>
<li>没有类型声明：<code>const xxx = require(&#39;&#39;)</code> 导入（默认导入为 any 类型）</li>
</ul>
<p>同样，js 中不同的 <code>export</code> 语法也对应着不同的声明方式。</p>
<h3 id="export-default"><a href="#export-default" class="headerlink" title="export default"></a>export default</h3><p>如果 js 是 <code>es6 module</code> 风格的，通过  <code>export default</code> 导出的，经过编译工具编译为 <code>export.default</code> 以后(一般为 babel 或其他工具编译)，则声明文件这样写：</p>
<p>js 源文件：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">function</span> (<span class="params">options</span>) &#123; &#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 编译后</span></span><br><span class="line"><span class="built_in">exports</span>.<span class="property">default</span> = <span class="keyword">function</span> (<span class="params">options</span>) &#123; &#125;</span><br></pre></td></tr></table></figure>

<p>d.ts 声明文件：</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 导出接口声明</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">interface</span> <span class="title class_">Options</span> &#123; &#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 声明默认函数</span></span><br><span class="line"><span class="keyword">declare</span> <span class="keyword">function</span> <span class="title function_">main</span> (<span class="attr">options</span>: <span class="title class_">Options</span>): <span class="built_in">void</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 导出默认值</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> main</span><br></pre></td></tr></table></figure>

<p>特点是这样引入(在 <code>tsconfig.json</code> 中没有开启 <code>allowSyntheticDefaultImports</code>  选项的情况下)：</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 导入包</span></span><br><span class="line"><span class="keyword">import</span> * <span class="keyword">as</span> demo <span class="keyword">from</span> <span class="string">&#x27;demo&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">Options</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;demo&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 调用默认方法</span></span><br><span class="line"><span class="title function_">demo</span>(&#123; &#125;)</span><br></pre></td></tr></table></figure>


<h3 id="module-exports"><a href="#module-exports" class="headerlink" title="module.exports"></a>module.exports</h3><p>如果 js 是 <code>commonjs</code> 风格的，是通过 <code>module.exports</code> 导出的，则声明文件这样写：</p>
<p>js 源文件：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = <span class="keyword">function</span> (<span class="params">options</span>) &#123; &#125;</span><br></pre></td></tr></table></figure>

<p>d.ts 声明文件：</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 包的声明</span></span><br><span class="line"><span class="keyword">declare</span> <span class="keyword">function</span> <span class="title function_">main</span> (<span class="attr">options</span>: main.<span class="property">Options</span>): <span class="built_in">void</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 包里面的接口通过 namespace 声明</span></span><br><span class="line"><span class="keyword">declare</span> <span class="keyword">namespace</span> main &#123;</span><br><span class="line">  <span class="comment">// 导出接口声明</span></span><br><span class="line">  <span class="keyword">export</span> <span class="keyword">interface</span> <span class="title class_">Options</span> &#123; &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 导出包默认声明</span></span><br><span class="line"><span class="keyword">export</span> = main</span><br></pre></td></tr></table></figure>

<p>特点是这样引入：</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 导入包</span></span><br><span class="line"><span class="keyword">import</span> demo = <span class="built_in">require</span>(<span class="string">&#x27;demo&#x27;</span>)</span><br><span class="line"><span class="comment">// 导入接口声明</span></span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">Options</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;demo&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 调用默认方法</span></span><br><span class="line"><span class="title function_">demo</span>(&#123; &#125;)</span><br></pre></td></tr></table></figure>


<h3 id="export-xxx"><a href="#export-xxx" class="headerlink" title="export xxx"></a>export xxx</h3><p>如果只是普通的 <code>exports xxx</code> ，经过编译工具编译为 <code>export.xxx</code> 之后，则声明文件相对简单：</p>
<p>js 源文件：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> <span class="title function_">func</span> = (<span class="params">options</span>) =&gt; &#123; &#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 编译为</span></span><br><span class="line"><span class="built_in">exports</span>.<span class="property">func</span> = <span class="keyword">function</span> (<span class="params">options</span>) &#123; &#125;</span><br></pre></td></tr></table></figure>

<p>d.ts 声明文件：</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 导出接口声明</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">interface</span> <span class="title class_">Options</span> &#123; &#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">declare</span> <span class="keyword">const</span> <span class="attr">func</span>: <span class="function">(<span class="params">options: Options</span>) =&gt;</span> <span class="built_in">void</span></span><br></pre></td></tr></table></figure>

<p>引入方式：</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 导入接口声明</span></span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">Options</span>, func &#125; <span class="keyword">from</span> <span class="string">&#x27;demo&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 调用</span></span><br><span class="line"><span class="title function_">func</span>(&#123; &#125;)</span><br></pre></td></tr></table></figure>

<h2 id="集成发布"><a href="#集成发布" class="headerlink" title="集成发布"></a>集成发布</h2><p>有两种主要方式用来发布类型定义文件到 <code>npm</code>：</p>
<ol>
<li>与你的 npm 包捆绑在一起(内置类型定义文件)</li>
<li>发布到 npm 上的 <a target="_blank" rel="noopener" href="https://www.npmjs.com/~types">@types organization</a></li>
</ol>
<p>前者，安装完了包之后会自动检测并识别类型定义文件。<br>后者，则需要通过 <code>npm i @types/xxxx</code> 安装，这就是我们前面所说的 <a target="_blank" rel="noopener" href="https://github.com/DefinitelyTyped/DefinitelyTyped">DefinitelyTyped</a> ，用于扩展 JS 库的类型声明。</p>
<h3 id="内置类型定义文件"><a href="#内置类型定义文件" class="headerlink" title="内置类型定义文件"></a>内置类型定义文件</h3><p>内置类型定义就是把你的类型定义文件和 npm 包一起发布，一般来说，类型定义文件都放在包根目录的 <code>types</code> 目录里，例如 <a target="_blank" rel="noopener" href="https://github.com/vuejs/vue/tree/v2.5.2/types">vue</a>：</p>
<p>如果你的包有一个主 <code>.js</code> 文件，需要在 <code>package.json</code> 里指定主类型定义文件。</p>
<p>设置 <code>types</code> 或 <code>typeings</code> 属性指向捆绑在一起的类型定义文件。 例如包目录如下：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">├── lib</span><br><span class="line">│   ├── main.js</span><br><span class="line">│   └── main.d.ts <span class="comment"># 类型定义文件</span></span><br><span class="line">└── package.json</span><br></pre></td></tr></table></figure>


<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// pageage.json</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="string">&quot;name&quot;</span>: <span class="string">&quot;demo&quot;</span>,</span><br><span class="line">    <span class="string">&quot;author&quot;</span>: <span class="string">&quot;demo project&quot;</span>,</span><br><span class="line">    <span class="string">&quot;version&quot;</span>: <span class="string">&quot;1.0.0&quot;</span>,</span><br><span class="line">    <span class="string">&quot;main&quot;</span>: <span class="string">&quot;./lib/main.js&quot;</span>,</span><br><span class="line">    <span class="comment">// 定义主类型定义文件</span></span><br><span class="line">    <span class="string">&quot;types&quot;</span>: <span class="string">&quot;./lib/main.d.ts&quot;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>如果主类型定义文件名是 <code>index.d.ts</code> 并且位置在包的根目录里，就不需要使用 <code>types</code> 属性指定了。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">├── lib</span><br><span class="line">│   └── main.js</span><br><span class="line">├── index.d.ts <span class="comment"># 类型定义文件</span></span><br><span class="line">└── package.json</span><br></pre></td></tr></table></figure>

<p>如果你发的包中，<code>package.json</code> 中使用了 <code>files</code> 字段的话（<code>npm</code> 会根据 <code>files</code> 配置的规则决定发布哪些文件），则需要手动把类型定义文件加入：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// pageage.json</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="string">&quot;files&quot;</span>: [</span><br><span class="line">    <span class="string">&quot;index.js&quot;</span>,</span><br><span class="line">    <span class="string">&quot;*.d.ts&quot;</span></span><br><span class="line">  ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


<p>如果只发二级目录的话，把类型定义文件放到对应的二级目录下即可：</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; <span class="keyword">default</span> <span class="keyword">as</span> <span class="title class_">App</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;demo/app&#x27;</span></span><br></pre></td></tr></table></figure>


<h3 id="发布到-types-organizatio"><a href="#发布到-types-organizatio" class="headerlink" title="发布到 @types organizatio"></a>发布到 @types organizatio</h3><p>发布到 <code>@types organizatio</code> 的包表示源包没有包含类型定义文件，第三方&#x2F;或原作者定义好类型定义文件之后，发布到 <a target="_blank" rel="noopener" href="https://www.npmjs.com/~types">@types</a> 中。例如 <a target="_blank" rel="noopener" href="https://www.npmjs.com/package/@types/express">@types&#x2F;express</a>。</p>
<p>根据 <code>DefinitelyTyped</code> 的规则，和编辑器(和插件) 自动检测静态类型。</p>
<p><a target="_blank" rel="noopener" href="https://www.npmjs.com/~types">@types</a> 下面的包是从 <a target="_blank" rel="noopener" href="https://github.com/DefinitelyTyped/DefinitelyTyped">DefinitelyTyped</a> 里自动发布的，通过 <a target="_blank" rel="noopener" href="https://github.com/Microsoft/types-publisher">types-publisher</a> 工具。 </p>
<p>如果想让你的包发布为 @types 包，需要提交一个 pull request 到 <a target="_blank" rel="noopener" href="https://github.com/DefinitelyTyped/DefinitelyTyped">https://github.com/DefinitelyTyped/DefinitelyTyped</a>。 </p>
<p>在这里查看详细信息 <a target="_blank" rel="noopener" href="http://definitelytyped.org/guides/contributing.html">contribution guidelines page</a>。</p>
<p>如果你正在使用 TypeScript，而使用了一些 JS 包并没有对应的类型定义文件，可以编写一份然后提交到 <code>@types</code>。</p>
<p>赠人玫瑰，手留余香。</p>
<p>发布到 <code>@types organizatio</code> 的包可以通过 <a target="_blank" rel="noopener" href="https://microsoft.github.io/TypeSearch/">TypeSearch</a> 搜索检索，使用 <code>npm install --save-dev @types/xxxx</code> 安装：</p>
<p><img src="//static.tasaid.com/blogs/26a7416bf2b8b2eebb74a32d2015eed3.png" alt="@types"></p>
<p>更多细节请参阅 <a target="_blank" rel="noopener" href="https://github.com/DefinitelyTyped/DefinitelyTyped">DefinitelyTyped</a>。</p>
<h2 id="其他"><a href="#其他" class="headerlink" title="其他"></a>其他</h2><h3 id="为第三方包声明类型"><a href="#为第三方包声明类型" class="headerlink" title="为第三方包声明类型"></a>为第三方包声明类型</h3><p>通常来说，如果这份类型定义文件是 JS 库自带的，那么我们可以直接导出模块：</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">interface</span> <span class="title class_">User</span> &#123;&#125;</span><br><span class="line"><span class="keyword">export</span> = <span class="title class_">User</span></span><br></pre></td></tr></table></figure>

<p>而如果这份类型定义文件不是 JS 库自带的，而是第三方的，则需要使用 <code>module</code> 进行关联。</p>
<p>例如 <code>jquery</code> 发布的 npm 包中不包含 <code>*.d.ts</code> 类型定义文件，<code>jquery</code> 的类型定义文件发布在了 <code>@types/jquery</code>，所以类型定义文件中导出类型的时候，需要关联模块 <code>jquery</code>，意思就是我专门针对这个包做的类型定义：</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">interface</span> jQuery &#123;&#125;</span><br><span class="line"><span class="keyword">declare</span> <span class="variable language_">module</span> <span class="string">&#x27;jquery&#x27;</span> &#123;</span><br><span class="line">    <span class="comment">// 因为 jquery 使用的是 commonjs module，所以需要用 export 导出</span></span><br><span class="line">    <span class="comment">// es6 module 可以使用 export default 导出</span></span><br><span class="line">    <span class="keyword">export</span> = jQuery;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>从而解决了一些主流的 JS 库发布的 <code>npm</code> 包中没有类型定义文件，但是我们可以用第三方类型定义文件为这些库补充类型。</p>
<h3 id="风格"><a href="#风格" class="headerlink" title="风格"></a>风格</h3><p>经过一系列探索，个人比较推荐下面的编写风格，先看目录：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">types</span><br><span class="line">├── application.d.ts</span><br><span class="line">├── config.d.ts</span><br><span class="line">├── index.d.ts <span class="comment"># 入口模块</span></span><br><span class="line">└── user.d.ts</span><br></pre></td></tr></table></figure>

<p><img src="//static.tasaid.com/blogs/b53c668059b6fc2f87dda190536d04f6.png"></p>
<p>入口模块主要做这些事情：</p>
<ol>
<li>定义命名空间</li>
<li>导出和聚合子模块</li>
</ol>
<p>主出口文件 <code>index.d.ts</code>：</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> * <span class="keyword">as</span> <span class="title class_">UserModel</span> <span class="keyword">from</span> <span class="string">&#x27;./user&#x27;</span></span><br><span class="line"><span class="keyword">import</span> * <span class="keyword">as</span> <span class="title class_">AppModel</span> <span class="keyword">from</span> <span class="string">&#x27;./application&#x27;</span></span><br><span class="line"><span class="keyword">import</span> * <span class="keyword">as</span> <span class="title class_">ConfigModel</span> <span class="keyword">from</span> <span class="string">&#x27;./config&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">declare</span> <span class="keyword">namespace</span> <span class="title class_">Models</span> &#123;</span><br><span class="line">  <span class="keyword">export</span> <span class="keyword">type</span> <span class="title class_">User</span> = <span class="title class_">UserModel</span>.<span class="property">User</span>;</span><br><span class="line">  <span class="keyword">export</span> <span class="keyword">type</span> <span class="title class_">Application</span> = <span class="title class_">AppModel</span>.<span class="property">Application</span>;</span><br><span class="line">  <span class="comment">// 利用 as 抹平争议性变量名</span></span><br><span class="line">  <span class="keyword">export</span> <span class="keyword">type</span> <span class="title class_">Config</span> = <span class="title class_">ConfigModel</span>.<span class="property">Config</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>子模块无需定义命名空间，这样外部环境 (<code>types</code> 文件夹之外) 则无法获取子模块类型，达到了类型封闭的效果：</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">interface</span> <span class="title class_">User</span> &#123;</span><br><span class="line">  <span class="attr">name</span>: <span class="built_in">string</span>;</span><br><span class="line">  <span class="attr">age</span>: <span class="built_in">number</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/posts/d4d0a06d/" data-id="cloizszuv0005xww622382tfe" data-title="JavaScript 和 TypeScript 交叉口 —— 类型定义文件(*.d.ts)" class="article-share-link"><span class="fa fa-share">Share</span></a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/TypeScript/" rel="tag">TypeScript</a></li></ul>

    </footer>
  </div>
  
    
<nav id="article-nav">
  
    <a href="/posts/d4134bcf/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Newer</strong>
      <div class="article-nav-title">
        
          JavaScript 中的 task queues
        
      </div>
    </a>
  
  
    <a href="/posts/7e42a592/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title">从 JavaScript 到 TypeScript 6 - Vue 引入 TypeScript</div>
    </a>
  
</nav>

  
</article>


</section>
        
          <aside id="sidebar">
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Categories</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/article/">article</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/tech/">tech</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tags</h3>
    <div class="widget">
      <ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="/tags/HTTPS/" rel="tag">HTTPS</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/JavaScript/" rel="tag">JavaScript</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Node-js/" rel="tag">Node.js</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Said/" rel="tag">Said</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/TypeScript/" rel="tag">TypeScript</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget tagcloud">
      <a href="/tags/HTTPS/" style="font-size: 12.5px;">HTTPS</a> <a href="/tags/JavaScript/" style="font-size: 17.5px;">JavaScript</a> <a href="/tags/Node-js/" style="font-size: 10px;">Node.js</a> <a href="/tags/Said/" style="font-size: 15px;">Said</a> <a href="/tags/TypeScript/" style="font-size: 20px;">TypeScript</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/10/">October 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/07/">July 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/08/">August 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/02/">February 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/12/">December 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/11/">November 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/09/">September 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/06/">June 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/04/">April 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/03/">March 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/01/">January 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/11/">November 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/10/">October 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/08/">August 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/05/">May 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/02/">February 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/01/">January 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/12/">December 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/11/">November 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/10/">October 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/09/">September 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/08/">August 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/06/">June 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/05/">May 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/04/">April 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/03/">March 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/02/">February 2016</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/posts/cfe1281/">一段职业生涯的总结</a>
          </li>
        
          <li>
            <a href="/posts/8127ee4b/">一段旅程</a>
          </li>
        
          <li>
            <a href="/posts/29a0bec0/">折旧</a>
          </li>
        
          <li>
            <a href="/posts/75b36508/">一无所知</a>
          </li>
        
          <li>
            <a href="/posts/688d139e/">TypeScript 中的多种 import 解义</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      
      &copy; 2023 John Doe<br>
      Powered by <a href="https://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>

    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    


<script src="/js/jquery-3.6.4.min.js"></script>



  
<script src="/fancybox/jquery.fancybox.min.js"></script>




<script src="/js/script.js"></script>





  </div>
</body>
</html>